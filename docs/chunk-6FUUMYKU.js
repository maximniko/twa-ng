import{a as R}from"./chunk-2BF7UKHN.js";import{a as z}from"./chunk-DBXTTL43.js";import{a as q}from"./chunk-ZSW6FWDP.js";import"./chunk-OQP2OZ6Y.js";import{a as h,b as P}from"./chunk-5ZQAWYED.js";import"./chunk-CTBJ2Y2T.js";import"./chunk-DHROBJAE.js";import{b as L,c as w}from"./chunk-UD6HGDXN.js";import{Ea as _,Ib as k,M as u,Na as E,Oa as l,Pa as F,Pb as O,Q as I,Qa as j,Ra as x,Ub as N,Vb as b,Wa as v,Za as A,_a as p,aa as a,ab as d,ba as o,ja as M,na as T,oa as c,pb as B,ra as y,tb as D,ub as f,v as S,wa as s,xa as r,ya as m}from"./chunk-7ZW7U2TK.js";var U=(n,g,t)=>({"bg-success":n,"bg-warning":g,"bg-danger":t}),G=(()=>{class n{constructor(t,e,i){this.localisation=t,this.settings=e,this.filter=i,this.available={percent:0,valuenow:0,valuemax:0}}ngOnInit(){this.calculateExisting(this.transactions)}calculateExisting(t){if(!t.length)return;let e=t.reduce((i,C)=>(i.valuenow+=C.total,i),{percent:0,valuenow:0,valuemax:0});e.valuemax=this.settings.item().maxPerMonth*this.filter.coefficient,e.percent=e.valuenow/e.valuemax*100,this.available=e}ngOnChanges(t){t.transactions&&this.calculateExisting(this.transactions)}static{this.\u0275fac=function(e){return new(e||n)(o(b),o(z),o(h))}}static{this.\u0275cmp=u({type:n,selectors:[["main-available"]],inputs:{transactions:"transactions"},standalone:!0,features:[I,v],decls:13,vars:27,consts:[[1,"p-3","rounded-3","tg-bg-secondary"],["role","progressbar","aria-label","Example with label","aria-valuemin","0",1,"progress"],[1,"progress-bar",3,"ngClass"],[1,"jcb","pt-3"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),p(3,"number"),l(4),p(5,"number"),r()(),s(6,"div",3)(7,"div"),l(8),p(9,"number"),r(),s(10,"div"),l(11),p(12,"number"),r()()()),e&2&&(a(),T("aria-valuenow",i.available.valuenow)("aria-valuemax",i.available.valuemax),a(),E("width: ",d(3,11,i.available.percent,"1.1-1"),"%"),c("ngClass",A(23,U,i.available.percent>0,i.available.percent>40,i.available.percent>64)),a(2),j("",d(5,14,i.available.percent,"1.1-1"),"% "),a(4),x("",i.localisation.t.Spent,": ",d(9,17,i.available.valuenow,"1.1-1"),""),a(3),x("",i.localisation.t.Available,": ",d(12,20,i.available.valuemax-i.available.valuenow,"1.1-1"),""))},dependencies:[f,B,D],encapsulation:2})}}return n})();function V(n,g){if(n&1&&(s(0,"section",0)(1,"div",2)(2,"span",3),l(3),r(),m(4,"period-selector"),r(),s(5,"div",4),m(6,"main-available",5),r(),s(7,"div",6),m(8,"transactions-list",5),r()()),n&2){let t,e=_();a(3),F((t=e.localisation.t.Transactions)!==null&&t!==void 0?t:"Transactions"),a(3),c("transactions",e.transactions),a(2),c("transactions",e.transactions)}}function W(n,g){n&1&&(s(0,"div",1),m(1,"main-intro"),r())}var pe=(()=>{class n{constructor(t,e,i,C,H){this.twa=t,this.filter=e,this.localisation=i,this.service=C,this.router=H,this.routeCreator=w}ngOnInit(){this.loadTransactions(this.filter.fromTo),this.filterSubscription=this.filter.nextFromTo.pipe(S(1e3)).subscribe(t=>this.loadTransactions(t)),this.twa.visibleBackButton(!1),this.twa.setMainButton({text:this.localisation.t.Add??"Add",is_active:!0,is_visible:!0,has_shine_effect:!0},()=>this.onMainClick())}ngOnDestroy(){this.twa.offMainButton(()=>this.onMainClick()),this.filterSubscription?.unsubscribe()}onMainClick(){this.router.navigate([w.transactionAdd()])}loadTransactions(t){this.service.list(new L(t)).subscribe(e=>this.transactions=e)}static{this.\u0275fac=function(e){return new(e||n)(o(N),o(h),o(b),o(O),o(k))}}static{this.\u0275cmp=u({type:n,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[v],decls:2,vars:1,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","card","rounded-5"],[1,"m-auto"],[1,"hstack","p-3","pb-0"],[1,"m-auto","text-center","h5"],[1,"card-body","p-2","my-3"],[3,"transactions"],[1,"card-body","p-2"]],template:function(e,i){e&1&&M(0,V,9,3,"section",0)(1,W,2,0,"div",1),e&2&&y(i.transactions.length?0:1)},dependencies:[f,q,P,R,G],encapsulation:2})}}return n})();export{pe as MainComponent};
