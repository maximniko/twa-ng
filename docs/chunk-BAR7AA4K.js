import{a as W}from"./chunk-KVPDOKPX.js";import{a as G}from"./chunk-2BF7UKHN.js";import{a as V}from"./chunk-W2P3CRGF.js";import{c as U}from"./chunk-4BFCTYDP.js";import{a as $,b as z}from"./chunk-WZCOGWEG.js";import"./chunk-CTBJ2Y2T.js";import{a as R}from"./chunk-DHROBJAE.js";import{c as b}from"./chunk-R42PM2GK.js";import{$a as T,Ea as v,Ib as P,Jb as A,M as h,Na as w,Oa as d,Pa as p,Rb as k,T as M,Ub as H,Vb as g,Wa as f,_a as E,aa as s,ba as c,ja as x,na as D,nb as B,oa as l,ra as y,sb as O,ua as L,ub as C,v as S,va as j,vb as F,wa as r,xa as n,ya as m}from"./chunk-7ZW7U2TK.js";var K=(()=>{class e{constructor(i){this.localisation=i,this.chartCategories=[],this.doughnutChartLabels=[],this.doughnutChartDatasets=[],this.doughnutChartOptions={animation:{animateRotate:!0,animateScale:!0},plugins:{legend:{position:"bottom",labels:{font:{size:16}}}},responsive:!0}}ngOnInit(){this.initChartData()}initChartData(){let t=this.chartCategories.reduce((o,u,_)=>(_<5?(o.labels.push(u.category.title),o.backgroundColors.push(u.color),o.data.push(u.total)):(o.labels[5]=this.localisation.t.Others??"Others",o.backgroundColors.push("#999"),o.data[5]=(o.data[5]??0)+u.total),o),{labels:[],backgroundColors:[],data:[]});this.doughnutChartLabels.push(...t.labels),this.doughnutChartDatasets.push({data:t.data,label:this.localisation.t.sum??"sum",borderWidth:1,backgroundColor:t.backgroundColors})}static{this.\u0275fac=function(t){return new(t||e)(c(g))}}static{this.\u0275cmp=h({type:e,selectors:[["chart-categories-doughnut"]],inputs:{chartCategories:"chartCategories"},standalone:!0,features:[f],decls:1,vars:5,consts:[["baseChart","",3,"labels","datasets","options","legend","type"]],template:function(t,o){t&1&&m(0,"canvas",0),t&2&&l("labels",o.doughnutChartLabels)("datasets",o.doughnutChartDatasets)("options",o.doughnutChartOptions)("legend",!0)("type","doughnut")},dependencies:[C,U],encapsulation:2})}}return e})();var Y=(e,a)=>a.category.id;function Z(e,a){if(e&1&&(r(0,"a",1)(1,"div",2)(2,"div",3),d(3),E(4,"uppercase"),n()(),r(5,"div",4)(6,"div",5)(7,"div",6),d(8),n()(),r(9,"div",7)(10,"div"),d(11),n(),r(12,"div"),d(13),n()()(),r(14,"div",8),M(),r(15,"svg",9),m(16,"use"),n()()()),e&2){let i,t=a.$implicit,o=v(2);l("routerLink",o.routeCreator.chartCategory(t.category)),s(),w("width:4rem;height:4rem;background-color:",t.color,";"),s(2),p(T(4,9,t.category.title.slice(0,1))),s(5),p(t.category.title),s(3),p((i=o.localisation.t.sum)!==null&&i!==void 0?i:"sum"),s(2),p(t.total),s(3),D("href","#"+o.symbols.chevronRight,null,"xlink")}}function tt(e,a){if(e&1&&(r(0,"div",0),L(1,Z,17,11,"a",1,Y),n()),e&2){let i=v();s(),j(i.chartCategories)}}var N=(()=>{class e{constructor(i){this.localisation=i,this.chartCategories=[],this.routeCreator=b,this.symbols=R}static{this.\u0275fac=function(t){return new(t||e)(c(g))}}static{this.\u0275cmp=h({type:e,selectors:[["chart-categories-list"]],inputs:{chartCategories:"chartCategories"},standalone:!0,features:[f],decls:1,vars:1,consts:[[1,"list-group"],[1,"list-group-item","hstack","pe-0",3,"routerLink"],[1,"rounded-circle","d-flex"],[1,"m-auto"],[1,"vstack","ps-3","jcc"],[1,"jcs"],[1,"text-truncate"],[1,"jcb"],[1,"jcc","px-3"],[1,"bi"]],template:function(t,o){t&1&&x(0,tt,3,0,"div",0),t&2&&y(o.chartCategories.length?0:-1)},dependencies:[C,O,A],encapsulation:2})}}return e})();var I=class{constructor(a){this.params=a}toHttpParams(){let a={};return this.params.categoryId&&(a.categoryId=this.params.categoryId),this.params.from&&(a.from=k(this.params.from)),this.params.to&&(a.to=k(this.params.to)),new F({fromObject:a})}filter(a){return this.params.categoryId?a.category.id==this.params.categoryId:this.params.categoryId==null}};function et(e,a){if(e&1&&(r(0,"section",0)(1,"div",2)(2,"span",3),d(3),n(),m(4,"period-selector"),n(),r(5,"div",4),m(6,"chart-categories-doughnut",5),n(),r(7,"div",4),m(8,"chart-categories-list",5),n(),m(9,"period-pagination"),n()),e&2){let i,t=v();s(3),p((i=t.localisation.t.Calculations)!==null&&i!==void 0?i:"Calculations"),s(3),l("chartCategories",t.chartCategories),s(2),l("chartCategories",t.chartCategories)}}function it(e,a){e&1&&(r(0,"div",1),m(1,"main-intro"),n())}var Dt=(()=>{class e{constructor(i,t,o,u,_,Q){this.twa=i,this.filter=t,this.localisation=o,this.location=u,this.service=_,this.router=Q,this.chartCategories=[],this.routeCreator=b}ngOnInit(){this.loadChartCategories(this.filter.fromTo),this.filterSubscription=this.filter.nextFromTo.pipe(S(1e3)).subscribe(i=>this.loadChartCategories(i)),this.twa.backButtonOnClick(()=>this.goBack()),this.twa.setMainButton({text:this.localisation.t.Add??"Add",is_active:!0,is_visible:!0,has_shine_effect:!0},()=>this.onMainClick())}ngOnDestroy(){this.twa.offMainButton(()=>this.onMainClick()),this.twa.offBackButton(()=>this.goBack()),this.filterSubscription?.unsubscribe()}goBack(){this.location.back()}onMainClick(){this.router.navigate([b.transactionAdd()])}loadChartCategories(i){this.service.list(new I(i)).subscribe(t=>this.chartCategories=t)}static{this.\u0275fac=function(t){return new(t||e)(c(H),c($),c(g),c(B),c(W),c(P))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[f],decls:2,vars:1,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","card","rounded-5"],[1,"m-auto"],[1,"hstack","p-3","pb-0"],[1,"m-auto","text-center","h5"],[1,"card-body","p-2"],[3,"chartCategories"]],template:function(t,o){t&1&&x(0,et,10,3,"section",0)(1,it,2,0,"div",1),t&2&&y(o.chartCategories.length?0:1)},dependencies:[C,K,N,z,V,G],encapsulation:2})}}return e})();export{Dt as MainComponent};
