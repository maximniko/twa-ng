import{a as N}from"./chunk-GTZIABMN.js";import{a as q}from"./chunk-EUTY2UME.js";import{a as R}from"./chunk-MDPOX252.js";import{a as P}from"./chunk-B3OX46JI.js";import"./chunk-OQP2OZ6Y.js";import{a as h,b as L}from"./chunk-3T2VUSZV.js";import"./chunk-CTBJ2Y2T.js";import"./chunk-KQRQU7YE.js";import"./chunk-YAH7JT7V.js";import{b as k,c as x}from"./chunk-QUWN2NEK.js";import{$ as r,Ca as y,Db as D,K as d,Kb as A,La as T,Ma as l,Na as _,O as S,Oa as v,Pb as O,Ta as f,Wa as F,Xa as p,Ya as u,_ as a,ha as M,la as E,lb as j,ma as c,ob as B,pa as I,pb as b,t as w,ua as s,va as o,wa as m}from"./chunk-DIXJAQJD.js";var K=(n,g,t)=>({"bg-success":n,"bg-warning":g,"bg-danger":t}),z=(()=>{class n{constructor(t,e){this.settings=t,this.filter=e,this.available={percent:0,valuenow:0,valuemax:0}}ngOnInit(){this.calculateExisting(this.transactions)}calculateExisting(t){if(!t.length)return;let e=t.reduce((i,C)=>(i.valuenow+=C.total,i),{percent:0,valuenow:0,valuemax:0});e.valuemax=this.settings.item().maxPerMonth*this.filter.coefficient,e.percent=e.valuenow/e.valuemax*100,this.available=e}ngOnChanges(t){t.transactions&&this.calculateExisting(this.transactions)}static{this.\u0275fac=function(e){return new(e||n)(r(R),r(h))}}static{this.\u0275cmp=d({type:n,selectors:[["main-available"]],inputs:{transactions:"transactions"},standalone:!0,features:[S,f],decls:13,vars:25,consts:[[1,"p-3","rounded-3","tg-bg-secondary"],["role","progressbar","aria-label","Example with label","aria-valuemin","0",1,"progress"],[1,"progress-bar",3,"ngClass"],[1,"jcb","pt-3"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),p(3,"number"),l(4),p(5,"number"),o()(),s(6,"div",3)(7,"div"),l(8),p(9,"number"),o(),s(10,"div"),l(11),p(12,"number"),o()()()),e&2&&(a(),E("aria-valuenow",i.available.valuenow)("aria-valuemax",i.available.valuemax),a(),T("width: ",u(3,9,i.available.percent,"1.1-1"),"%"),c("ngClass",F(21,K,i.available.percent>0,i.available.percent>40,i.available.percent>64)),a(2),v("",u(5,12,i.available.percent,"1.1-1"),"% "),a(4),v("\u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E: ",u(9,15,i.available.valuenow,"1.1-1"),""),a(3),v("\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E: ",u(12,18,i.available.valuemax-i.available.valuenow,"1.1-1"),""))},dependencies:[b,j,B],encapsulation:2})}}return n})();function Q(n,g){if(n&1&&(s(0,"section",0)(1,"div",2)(2,"span",3),l(3),o(),m(4,"period-selector"),o(),s(5,"div",4),m(6,"main-available",5),o(),s(7,"div",6),m(8,"transactions-list",5),o()()),n&2){let t,e=y();a(3),_((t=e.localisation.t.transactions)!==null&&t!==void 0?t:"Transactions"),a(3),c("transactions",e.transactions),a(2),c("transactions",e.transactions)}}function U(n,g){n&1&&(s(0,"div",1),m(1,"main-intro"),o())}var me=(()=>{class n{constructor(t,e,i,C,G){this.twa=t,this.filter=e,this.localisation=i,this.service=C,this.router=G,this.routeCreator=x}ngOnInit(){this.loadTransactions(this.filter.fromTo),this.filterSubscription=this.filter.nextFromTo.pipe(w(1e3)).subscribe(t=>this.loadTransactions(t)),this.twa.visibleBackButton(!1),this.twa.setMainButton({text:"Add transaction",is_active:!0,is_visible:!0,has_shine_effect:!0},()=>this.onMainClick())}ngOnDestroy(){this.twa.offMainButton(()=>this.onMainClick()),this.filterSubscription?.unsubscribe()}onMainClick(){this.router.navigate([x.transactionAdd()])}loadTransactions(t){this.service.list(new k(t)).subscribe(e=>this.transactions=e)}static{this.\u0275fac=function(e){return new(e||n)(r(O),r(h),r(q),r(A),r(D))}}static{this.\u0275cmp=d({type:n,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[f],decls:2,vars:1,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","card","rounded-5"],[1,"m-auto"],[1,"hstack","p-3","pb-0"],[1,"m-auto","text-center","h5"],[1,"card-body","p-2","my-3"],[3,"transactions"],[1,"card-body","p-2"]],template:function(e,i){e&1&&M(0,Q,9,3,"section",0)(1,U,2,0,"div",1),e&2&&I(i.transactions.length?0:1)},dependencies:[b,P,L,N,z],encapsulation:2})}}return n})();export{me as MainComponent};
