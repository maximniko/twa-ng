import{a as S}from"./chunk-OQP2OZ6Y.js";import{a as $,b as B}from"./chunk-7JAAA2YT.js";import{c as R}from"./chunk-EQ6DK4UO.js";import{a as O}from"./chunk-VKM6DCX6.js";import{a as D}from"./chunk-L2LZDF6K.js";import{Ab as M,Ea as b,Gb as F,Ib as j,Jb as I,M as h,Na as T,Oa as p,Pa as f,Sa as C,T as _,aa as c,ba as g,ja as x,lb as v,na as L,oa as m,ra as y,ua as k,va as w,wa as a,xa as r,xb as E,ya as d}from"./chunk-B4RSPJCF.js";var U=(()=>{class e{constructor(){this.transactions=[],this.doughnutChartLabels=[],this.doughnutChartDatasets=[],this.doughnutChartOptions={animation:{animateRotate:!0,animateScale:!0},responsive:!0}}ngOnInit(){this.initChartData()}initChartData(){let t=this.chartDate;this.doughnutChartLabels.push(...t.labels),this.doughnutChartDatasets.push({data:t.data,label:"sum",borderWidth:1,backgroundColor:t.backgroundColors})}get chartDate(){let t=this.transactions.reduce((n,o)=>(n[o.tag.id]?n[o.tag.id].total+=o.total:n[o.tag.id]={id:o.tag.id,title:o.tag.title,total:o.total},n),{}),s=Object.keys(t).reduce((n,o)=>(n.push(t[o]),n),[]).sort((n,o)=>n.total>o.total?-1:1),u=5;return s.reduce((n,o,G)=>(G<u?(n.labels.push(o.title),n.backgroundColors.push(S(o.id)),n.data.push(o.total)):(n.labels[u]="Others",n.backgroundColors.push("#999"),n.data[u]=(n.data[u]??0)+o.total),n),{labels:[],backgroundColors:[],data:[]})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=h({type:e,selectors:[["chart-transactions-doughnut"]],inputs:{transactions:"transactions"},standalone:!0,features:[C],decls:1,vars:5,consts:[["baseChart","",3,"labels","datasets","options","legend","type"]],template:function(i,s){i&1&&d(0,"canvas",0),i&2&&m("labels",s.doughnutChartLabels)("datasets",s.doughnutChartDatasets)("options",s.doughnutChartOptions)("legend",!0)("type","doughnut")},dependencies:[v,R],encapsulation:2})}}return e})();function P(e,l){return e.toLocaleDateString(l,{month:"short",day:"numeric"})}var Y=(e,l)=>l.id;function z(e,l){if(e&1&&(a(0,"a",1),d(1,"div",2),a(2,"div",3)(3,"div",4)(4,"div",5),p(5),r(),a(6,"div"),p(7),r()(),a(8,"div",4)(9,"div"),p(10,"Sum:"),r(),a(11,"div"),p(12),r()()(),a(13,"div",6),_(),a(14,"svg",7),d(15,"use"),r()()()),e&2){let t=l.$implicit,i=b(2);m("routerLink",i.routeCreator.transactionEdit(t)),c(),T("width:4rem;height:4rem;background-color:",i.getColor(t.tag.id),";"),c(4),f(t.tag.title),c(2),f(i.toLocalDate(t.date)),c(5),f(t.total),c(3),L("href","#"+i.symbols.chevronRight,null,"xlink")}}function H(e,l){if(e&1&&(a(0,"div",0),k(1,z,16,8,"a",1,Y),r()),e&2){let t=b();c(),w(t.transactions)}}var q=(()=>{class e{constructor(t){this.twa=t,this.transactions=[],this.routeCreator=I,this.symbols=O,this.getColor=S,this.toLocalDate=i=>P(i,this.twa.getUserLanguageCode())}static{this.\u0275fac=function(i){return new(i||e)(g(D))}}static{this.\u0275cmp=h({type:e,selectors:[["chart-transactions-list"]],inputs:{transactions:"transactions"},standalone:!0,features:[C],decls:1,vars:1,consts:[[1,"list-group"],[1,"list-group-item","list-group-item-action","hstack","pe-0",3,"routerLink"],[1,"rounded-circle","d-flex"],[1,"vstack","ps-3","jcc"],[1,"jcb"],[1,"text-truncate"],[1,"jcc","px-3"],[1,"bi"]],template:function(i,s){i&1&&x(0,H,3,0,"div",0),i&2&&y(s.transactions.length?0:-1)},dependencies:[v,M],encapsulation:2})}}return e})();function J(e,l){if(e&1&&(a(0,"div",3),d(1,"chart-transactions-doughnut",4),r(),a(2,"div",3),d(3,"chart-transactions-list",4),r()),e&2){let t=b();c(),m("transactions",t.transactions),c(2),m("transactions",t.transactions)}}var gt=(()=>{class e{constructor(t,i,s){this.twa=t,this.service=i,this.activatedRoute=s,this.transactions=[],this.routeCreator=I,this.activatedRoute.data.subscribe(u=>{this.categoryItem=u.categoryItem,this.service.list(new j({categoryId:this.categoryItem.id})).subscribe(n=>this.transactions=n)})}ngOnInit(){this.twa.visibleBackButton(!1),this.twa.setMainButton({text:"Add transaction",is_active:!0,is_visible:!0,has_shine_effect:!0},()=>{})}static{this.\u0275fac=function(i){return new(i||e)(g(D),g(F),g(E))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],hostAttrs:[1,"d-flex","flex-column","h-100"],standalone:!0,features:[C],decls:7,vars:2,consts:[[1,"accent-border","accent-border-top","accent-bg-shadow","card","rounded-5"],[1,"hstack","p-3","pb-0"],[1,"m-auto","text-center","h5"],[1,"card-body","p-2"],[3,"transactions"]],template:function(i,s){i&1&&(a(0,"section",0)(1,"div",1)(2,"span",2),p(3),r(),d(4,"period-selector"),r(),x(5,J,4,2),d(6,"period-pagination"),r()),i&2&&(c(3),f(s.categoryItem.title),c(2),y(s.transactions.length?5:-1))},dependencies:[v,U,q,B,$],encapsulation:2})}}return e})();export{gt as ChartCategoryComponent};
